# Create a new directory and enter it
function mkd() {
  mkdir -p "$@" && cd "$_";
}

# Generate ssh key
function ssh-generate-key() {
  local email="" key="$1";
	email=$(git config --global user.email);

  if [ -z "$key" ]; then
    echo "Please supply name of the ssh key";
  else
    ssh-keygen -t rsa -b 4096 -C "$email" -N "" -f ~/.ssh/"$key";
    pbcopy <  ~/.ssh/"$key".pub
  fi
}

# Simple Calculator
function calc() {
  echo "$*" | bc -l;
}

# Start an HTTP server from a directory, optionally specifying the port
function server() {
  local port="${1:-8000}";
  sleep 1 && open "http://localhost:${port}/" &
  # Set the default Content-Type to `text/plain` instead of `application/octet-stream`
  # And serve everything as UTF-8 (although not technically correct, this doesnâ€™t break anything for binary files)
  python -c $'import SimpleHTTPServer;\nmap = SimpleHTTPServer.SimpleHTTPRequestHandler.extensions_map;\nmap[""] = "text/plain";\nfor key, value in map.items():\n\tmap[key] = value + ";charset=UTF-8";\nSimpleHTTPServer.test();' "$port";
}
           
# Copy w/ progress
cp_p () {
  rsync -WavP --human-readable --progress "$1" "$2";
}

# `tre` is a shorthand for `tree` with hidden files and color enabled, ignoring
# some directories, listing directories first. The output gets piped into
# `less` with options to preserve color and line numbers, unless the output is
# small enough for one screen.
function tre() {
  tree -aC -I '.git|node_modules|bower_components|.gradle|.idea|.svn|.sass-cache' --dirsfirst "$@" | less -FRNX;
}
  
function digs() {
  dig -t "$1" "$2" +short;
}

# Delete all containers
function docker-clean-all-containers {
  local containers="";
	containers="$(docker ps -a -q)";
  [ ! -z "$containers" ] && docker rm "$containers";
	[ -z "$containers" ] && echo "No containers to clean!";
}

# Delete all images
function docker-clean-all-images {
  local images="";
	images="$(docker images -q)";
  [ ! -z "$images" ] && docker rmi "$images";
	[ -z "$images" ] && echo "No images to clean!";
}

function docker-clean-all {
  docker-clean-all-containers;
	docker-clean-all-images;
}

# Switch between platforms
case $(uname) in
  'Darwin')

    # Open man page as PDF (OS X Only)
    function manpdf() {
      man -t "$1" | open -f -a /Applications/preview.app/;
    }
  ;;
esac
